x0 = [3000.0, 1000000.0, 2.0, 2000.0, 0.0005, 40000.0, 9.0, 2.0, 3000000.0, 2e-06, 0.3, 7.0, 2.0, 7.0, 2.0, 80.0, 40000000.0, 7000.0, 0.4, 1.0, 7000.0, 10000.0, 2000.0, 40.0, 10.0, 0.0008, 0.005, 20.0, 0.8, 0.1, 1.0, 10.0, 3.0, 400000.0, 10.0, ];
options = optimset('fmincon');
options.Algorithm = 'interior-point';
options.MaxFunEvals = Inf;
options.MaxIter = Inf;
options.GradObj = 'on';
options.GradConstr = 'on';
options.TolCon = 1E-10;
%options.TolConSQP = 1E-8;
%options.DerivativeCheck = 'on';
tic;
[x,fval] = ...
fmincon(@objfun,x0,[],[],[],[],[],[],@confun,options);
elapsed = toc;
fid = fopen('elapsed.txt', 'w');
fprintf(fid, '%.1f', elapsed);
fclose(fid);
fid = fopen('cost.txt', 'w');
fprintf(fid, '%.5g', fval);
fclose(fid);